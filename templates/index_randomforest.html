<!DOCTYPE html> 
<html lang="en"> 
<head> 
<meta charset="UTF-8"> 
<title> Flood Prediction System </title>
<meta name="viewport" content="initial-scale=1.0, width=device-width" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css"
integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA=="   crossorigin=""/>
<script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"
   integrity="sha512-QVftwZFqvtRNi0ZyCtsznlKSWOStnDORoefr1enyq5mVL4tmKB3S/EnC3rRJcxCPavG10IcrVGSmPh6Qw5lwrg=="
   crossorigin=""></script>
<!--<script type="text/javascript" src="/eel.js"></script>-->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
window.onload = function()
{
a = document.getElementById("location");
var userloc = a.options[a.selectedIndex].value;
report(userloc);
};
function report(loc){
    document.getElementById("myTable").value="";
    //document.getElementById("tide").value="";
    //document.getElementById("drainvalue").innerHTML="";
    //document.getElementById("res").innerHTML="";
if(loc=='Santacruz'){     
    alert("santacruz");
    document.getElementById('mapid').innerHTML = "<div id='smap' style='width: 100%; height: 100%;'></div>";
    
 var smap = L.map('smap').setView([ 19.084563, 72.834836 ], 13);
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoic2FoaWwtbWFwYm94IiwiYSI6ImNqc3VyMTVoNzIweTM0Ym82M3NuOGd4OTMifQ.ictab7heJhKcl5VjSLQjTA', {    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
    maxZoom: 18,    id: 'mapbox.streets',
    accessToken: 'pk.eyJ1Ijoic2FoaWwtbWFwYm94IiwiYSI6ImNqc3VyMTVoNzIweTM0Ym82M3NuOGd4OTMifQ.ictab7heJhKcl5VjSLQjTA'
}).addTo(smap);
geojsonFeature_Santacruz={
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
  		"geometry": {
       "type": "Polygon",
        "coordinates": [
          [
            [
              72.82999992370605,
              19.087994472614195
            ],
            [
              72.82570838928223,
              19.08823780693182
            ],
            [
              72.82570838928223,
              19.080430652608708
            ],
            [
              72.83675909042358,
              19.079883124080123
            ],
            [
              72.83796072006224,
              19.087710582124963
            ],
            [
              72.82999992370605,
              19.087994472614195
            ]
          ]
        ]
      },
      "style": {
        "stroke": "#555555",
        "stroke-width": "2",
        "stroke-opacity": 1.0,
        "fillColor": '#ffffff',
        "fill-opacity": 0.5
      }    
    }
  ]
};
      myStyle_Santacruz = {
    "color": "red",
    "weight": 5,
    "opacity": 0.8
};
    //var col=color_output();
	//var col=0;
    //if(col==1){
	//L.geoJSON(geojsonFeature,{style:myStyle}).addTo(smap);
	//} 
    //else{
	L.geoJSON(geojsonFeature_Santacruz).addTo(smap);
	//}	
      
     
}   
else{
    alert("colaba");
    document.getElementById('mapid').innerHTML = "<div id='cmap' style='width: 100%; height: 100%;'></div>";
    //mymap.remove();
 var colabamap = new L.map('cmap').setView([ 18.92, 72.81 ], 13);
L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoic2FoaWwtbWFwYm94IiwiYSI6ImNqc3VyMTVoNzIweTM0Ym82M3NuOGd4OTMifQ.ictab7heJhKcl5VjSLQjTA', {
    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
    maxZoom: 18,
    id: 'mapbox.streets',
    accessToken: 'pk.eyJ1Ijoic2FoaWwtbWFwYm94IiwiYSI6ImNqc3VyMTVoNzIweTM0Ym82M3NuOGd4OTMifQ.ictab7heJhKcl5VjSLQjTA'
}).addTo(colabamap);
 geojsonFeature_Colaba={
  "type": "FeatureCollection",
  "features": [
    {
      "type": "Feature",
      "properties": {
        "stroke": "#555555",
        "stroke-width": 3,
        "stroke-opacity": 1,
        "fill": "#0c769e",
        "fill-opacity": 0.5},
      "geometry": {
        "type": "Polygon",
        "coordinates": [
          [
            [
              72.81806945800781,
              18.925448623194445
            ],
            [
              72.82639503479004,
              18.922282151953898
            ],
            [
              72.82244682312012,
              18.917166956302424
            ],
            [
              72.8144645690918,
              18.911645617107514
            ],
            [
              72.80450820922852,
              18.903525669500272
            ],
            [
              72.80742645263672,
              18.890370518100625
            ],
            [
              72.83411979675293,
              18.922038574758123
            ],
            [
              72.84098625183105,
              18.920252331142763
            ],
            [
              72.83712387084961,
              18.92731600118485
            ],
            [
              72.81806945800781,
              18.925448623194445
            ]
          ]
        ]
      }
    }
  ]
};
     myStyle_Colaba = {
    "color": "red",
    "weight": 5,
    "opacity": 0.8
};
    //var col=color_output();
	//var col=1;
    //if(col==1){
	//L.geoJSON(geojsonFeature,{style:myStyle}).addTo(colabamap);
	//}    else{
	L.geoJSON(geojsonFeature_Colaba).addTo(colabamap);
	//}	    
}
    
}

/*function multiplyFactor(){
    a=document.getElementById("location");
            var loc = a.options[a.selectedIndex].value;  
                if(loc=='Santacruz')
               { 
               // alert('Santacruz');
                var r = document.getElementById("rainfall").value;
                var d = r* 7.83;
                document.getElementById('drainvalue').innerHTML = d;
               }else     //(loc=='Colaba')
              { //alert('Colaba');
                var r = document.getElementById("rainfall").value;
                var d = r * 1.74;
                document.getElementById('drainvalue').innerHTML = d; } 
}*/
    function drain()
            {
                a=document.getElementById("location");
            var loc = a.options[a.selectedIndex].value;  
                if(loc=='Santacruz')
               { 
               // alert('Santacruz');
                var r = document.getElementById("rainfall").value;
                var d = r* 7.83;
                //document.getElementById('drainvalue').innerHTML = d;
                var t = document.getElementById("tide").value;
                //eel.expose(svm_function);
                eel.svm_function(loc,r,d,t)(print_return);
               }
              else     //(loc=='Colaba')
              { //alert('Colaba');
                var r = document.getElementById("rainfall").value;
                var d = r * 1.74;
                //document.getElementById('drainvalue').innerHTML = d;   
                var t = document.getElementById("tide").value;
                //eel.expose(svm_function);
                eel.svm_function(loc,r,d,t)(print_return);       

              }
            }
function print_return(result_calc){
    if(result_calc[0]=="Santacruz"&& result_calc[1]==1){
		document.getElementById("res").innerHTML="Result: Flood Occured "+result_calc[0]+" "+result_calc[1];
 		document.getElementById('mapid').innerHTML = "<div id='smap' style='width: 100%; height: 100%;'></div>";
 		var smap = L.map('smap').setView([ 19.084563, 72.834836 ], 13);
		L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoic2FoaWwtbWFwYm94IiwiYSI6ImNqc3VyMTVoNzIweTM0Ym82M3NuOGd4OTMifQ.ictab7heJhKcl5VjSLQjTA', {    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
    		maxZoom: 18,    id: 'mapbox.streets',
    		accessToken: 'pk.eyJ1Ijoic2FoaWwtbWFwYm94IiwiYSI6ImNqc3VyMTVoNzIweTM0Ym82M3NuOGd4OTMifQ.ictab7heJhKcl5VjSLQjTA'
		}).addTo(smap);
		L.geoJSON(geojsonFeature_Santacruz,{style:myStyle_Santacruz}).addTo(smap);

        }
        else if (result_calc[0]=="Colaba"&& result_calc[1]==1) {
        	document.getElementById("res").innerHTML="Result: Flood Occured "+result_calc[0]+" "+result_calc[1];
 			document.getElementById('mapid').innerHTML = "<div id='cmap' style='width: 100%; height: 100%;'></div>";
 			var colabamap = new L.map('cmap').setView([ 18.92, 72.81 ], 13);
			L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1Ijoic2FoaWwtbWFwYm94IiwiYSI6ImNqc3VyMTVoNzIweTM0Ym82M3NuOGd4OTMifQ.ictab7heJhKcl5VjSLQjTA', {
    		attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
    		maxZoom: 18,
    		id: 'mapbox.streets',
    		accessToken: 'pk.eyJ1Ijoic2FoaWwtbWFwYm94IiwiYSI6ImNqc3VyMTVoNzIweTM0Ym82M3NuOGd4OTMifQ.ictab7heJhKcl5VjSLQjTA'
			}).addTo(colabamap);
 
			L.geoJSON(geojsonFeature_Colaba,{style:myStyle_Colaba}).addTo(colabamap);
        }
        else{
			document.getElementById("res").innerHTML="Result: Flood Not Occured "+result_calc[0]+" "+result_calc[1];
               
        }}
    function fetchAPIData(){

var url="http://api.worldweatheronline.com/premium/v1/weather.ashx?key=811c892f33bb4688802102448191903&q=mumbai&format=json&num_of_days=5&tp=24"
jsonP(url);
function jsonP(url){
 $.ajax({
        type: 'GET',
        url: url,
        async: false,
        contentType: "application/json",
        dataType: 'jsonp',
        success: function (json) {
              var i,j,date,humidity,precipMM,tempC,pressure,windspeedKmph;

                            console.log(json);
              for (i = 0; i < 5; i++) { 
                        date=json.data.weather[i].date;
                        for(j=0;j<1;j++ ) {
                            humidity=json.data.weather[i].hourly[j].humidity;
                            precipMM=json.data.weather[i].hourly[j].precipMM;
                            pressure=json.data.weather[i].hourly[j].pressure;
                            tempC=json.data.weather[i].hourly[j].tempC;
                            windspeedKmph=json.data.weather[i].hourly[j].windspeedKmph;

                            document.getElementById("myTable").rows[i+1].cells[0].innerHTML=date;
                            document.getElementById("myTable").rows[i+1].cells[1].innerHTML=humidity;
                            document.getElementById("myTable").rows[i+1].cells[2].innerHTML=precipMM;
                            document.getElementById("myTable").rows[i+1].cells[3].innerHTML=pressure;
                            document.getElementById("myTable").rows[i+1].cells[4].innerHTML=tempC;
                            document.getElementById("myTable").rows[i+1].cells[5].innerHTML=windspeedKmph;
}
                    


}
}
        ,
        error: function (e) {
            alert(e.message);
        }
    });
}


    }


        </script>
<style>
 
    .form-style-4{
        width: 100%;
        font-size: 16px;
        background: #E6E6FA;
        padding: 30px 30px 15px 30px;
        border: 5px solid #53687E;     
    }
    .form-style-4 input[type=submit],
    .form-style-4 input[type=button],
    .form-style-4 textarea,
    .form-style-4 label
    {   font-family: Georgia, "Times New Roman", Times, serif;
        font-size: 16px;
        color: black;    
    }
    .form-style-4 label {
        display:inline-block;
        margin-bottom: 10px;
    }
    .form-style-4 label > span{
        display: inline-block;
        float: left;
        width: 150px;
    }
    .form-style-4 input[type=text],
    .form-style-4 input[type=number] 
    {   width: 275px;
        outline: none;
    }
    .width{
        width: 275px;
        outline: none;
    }
.style-div{
/*align-content: center;*/
   
   width: 95%;
}
    .form-style-4 input[type=submit],
    .form-style-4 input[type=button]{
       
        border: 1px solid white;
        padding: 8px 10px 8px 10px;
        border-radius: 5px;
        border-color: black;
        color: black;
    }
    .form-style-4 input[type=submit]:hover,
    .form-style-4 input[type=button]:hover{
  
    } 
    
    table, th, td {
  border: 1px solid black;
  border-collapse: collapse;
  width:600px;
  color: black;
  padding: 5px;
  text-align: center;
  font-size: 15px;
}
</style>
</head> 
<body>
<div><div class="style-div">
<form class="form-style-4" action="" method="post" >
<label for ="field0">
    <span>Location</span>
    <select name="Location" id="location" class="width" onchange="report(this.value)" >
        <option value="Santacruz">Santacruz</option> 
        <option value="Colaba">Colaba</option>
    </select>
</label>

<span><input type="button" style="margin-left: 35px;" value="Fetch Data through API" onclick="fetchAPIData();"></input></span><label>
<span> </span>
    <input type="button" value="Submit" style="margin-left: 35px;" onclick=" fetchAPIData();" />
</label>


<table style="width:100%" id="myTable">
  <tr>
    <th>Date</th>
    <th>Humidity</th> 
    <th>PrecipMM/24h</th>
    <th>Pressure</th>
    <th>TempC</th> 
    <th>WindSpeedKMPH</th>
    <th>Result</th>
  </tr>
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    
  </tr>
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    
  </tr>
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    
  </tr>
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    
  </tr>
  <tr>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    <td></td>
    
  </tr>
    <caption align="bottom">
<div >Powered by <a style="color: black" href="https://www.worldweatheronline.com/" title="Weather API">World Weather Online</a>


  </div></caption>
</table>
</form></div>
</div> <!--  <p id="demo1">R</p>    <p id="demo2">D</p>    <p id="demo3">T</p>-->
    
<div style="width: 100%; height: 375px; margin-top: 1px; margin-right: 2px;  border: 5px solid #53687E; " class="style-div" id="mapid"></div>
</body>
</html>
